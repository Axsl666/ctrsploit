package main

import (
	"github.com/ssst0n3/awesome_libs/log"
	"net/http"
	"net/http/httputil"
)

func main() {
	http.HandleFunc("/token", func(writer http.ResponseWriter, request *http.Request) {
		dump, _ := httputil.DumpRequest(request, true)
		log.Logger.Infof("\n%s\n", dump)
	})
	http.HandleFunc("/", func(writer http.ResponseWriter, request *http.Request) {
		writer.Header().Set("Www-Authenticate", "Bearer realm=\"http://xxxx:3389/token\",service=\"dockyard\",scope=\"repository:dkdk/private:pull\"")
		writer.WriteHeader(http.StatusUnauthorized)
	})
	http.ListenAndServe("0.0.0.0:3389", nil)
}
