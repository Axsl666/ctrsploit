package CVE_2020_8555

import (
	"github.com/docker/docker/pkg/reexec"
	"os"
)

const (
	ScannerName = "cve-2020-8555_scanner"
	ProxyName   = "cve-2020-8555_proxy"
)

func init() {
	reexec.Register(ScannerName, Scanner)
	reexec.Register(ProxyName, Proxy)
}

func InvokeScanner() {
	cmd := reexec.Command(ScannerName)
	cmd.Stderr = os.Stderr
	cmd.Stdout = os.Stdout
	cmd.Stdin = os.Stdin
	cmd.Run()
}

func InvokeProxy() {
	cmd := reexec.Command(ProxyName)
	cmd.Stderr = os.Stderr
	cmd.Stdout = os.Stdout
	cmd.Stdin = os.Stdin
	cmd.Run()
}
